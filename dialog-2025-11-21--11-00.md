## Me:

```
((.venv) ) ➜  uav-nest-agent-by-langchain-and-langgraph (stage2-multi-source-rag) ✗)python3 -m pip install unstructured cryptography
Collecting unstructured
  Downloading unstructured-0.18.20-py3-none-any.whl.metadata (25 kB)
Collecting cryptography
  Downloading cryptography-46.0.3-cp311-abi3-macosx_10_9_universal2.whl.metadata (5.7 kB)
Requirement already satisfied: charset-normalizer in ./.venv/lib/python3.12/site-packages (from unstructured) (3.4.4)
Collecting filetype (from unstructured)
  Downloading filetype-1.2.0-py2.py3-none-any.whl.metadata (6.5 kB)
Collecting python-magic (from unstructured)
  Downloading python_magic-0.4.27-py2.py3-none-any.whl.metadata (5.8 kB)
Collecting lxml (from unstructured)
  Downloading lxml-6.0.2-cp312-cp312-macosx_10_13_universal2.whl.metadata (3.6 kB)
Collecting nltk (from unstructured)
  Downloading nltk-3.9.2-py3-none-any.whl.metadata (3.2 kB)
Requirement already satisfied: requests in ./.venv/lib/python3.12/site-packages (from unstructured) (2.32.5)
Collecting beautifulsoup4 (from unstructured)
  Downloading beautifulsoup4-4.14.2-py3-none-any.whl.metadata (3.8 kB)
Collecting emoji (from unstructured)
  Downloading emoji-2.15.0-py3-none-any.whl.metadata (5.7 kB)
Requirement already satisfied: dataclasses-json in ./.venv/lib/python3.12/site-packages (from unstructured) (0.6.7)
Collecting python-iso639 (from unstructured)
  Downloading python_iso639-2025.11.16-py3-none-any.whl.metadata (15 kB)
Collecting langdetect (from unstructured)
  Downloading langdetect-1.0.9.tar.gz (981 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 981.5/981.5 kB 7.1 MB/s  0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Requirement already satisfied: numpy in ./.venv/lib/python3.12/site-packages (from unstructured) (2.3.5)
Collecting rapidfuzz (from unstructured)
  Downloading rapidfuzz-3.14.3-cp312-cp312-macosx_11_0_arm64.whl.metadata (12 kB)
Collecting backoff (from unstructured)
  Downloading backoff-2.2.1-py3-none-any.whl.metadata (14 kB)
Requirement already satisfied: typing-extensions in ./.venv/lib/python3.12/site-packages (from unstructured) (4.15.0)
Collecting unstructured-client (from unstructured)
  Downloading unstructured_client-0.42.4-py3-none-any.whl.metadata (23 kB)
Collecting wrapt (from unstructured)
  Downloading wrapt-2.0.1-cp312-cp312-macosx_11_0_arm64.whl.metadata (9.0 kB)
Requirement already satisfied: tqdm in ./.venv/lib/python3.12/site-packages (from unstructured) (4.67.1)
Collecting psutil (from unstructured)
  Downloading psutil-7.1.3-cp36-abi3-macosx_11_0_arm64.whl.metadata (23 kB)
Collecting python-oxmsg (from unstructured)
  Downloading python_oxmsg-0.0.2-py3-none-any.whl.metadata (5.0 kB)
Collecting html5lib (from unstructured)
  Downloading html5lib-1.1-py2.py3-none-any.whl.metadata (16 kB)
Collecting cffi>=2.0.0 (from cryptography)
  Downloading cffi-2.0.0-cp312-cp312-macosx_11_0_arm64.whl.metadata (2.6 kB)
Collecting pycparser (from cffi>=2.0.0->cryptography)
  Downloading pycparser-2.23-py3-none-any.whl.metadata (993 bytes)
Collecting soupsieve>1.2 (from beautifulsoup4->unstructured)
  Downloading soupsieve-2.8-py3-none-any.whl.metadata (4.6 kB)
Requirement already satisfied: marshmallow<4.0.0,>=3.18.0 in ./.venv/lib/python3.12/site-packages (from dataclasses-json->unstructured) (3.26.1)
Requirement already satisfied: typing-inspect<1,>=0.4.0 in ./.venv/lib/python3.12/site-packages (from dataclasses-json->unstructured) (0.9.0)
Requirement already satisfied: packaging>=17.0 in ./.venv/lib/python3.12/site-packages (from marshmallow<4.0.0,>=3.18.0->dataclasses-json->unstructured) (25.0)
Requirement already satisfied: mypy-extensions>=0.3.0 in ./.venv/lib/python3.12/site-packages (from typing-inspect<1,>=0.4.0->dataclasses-json->unstructured) (1.1.0)
Requirement already satisfied: six>=1.9 in ./.venv/lib/python3.12/site-packages (from html5lib->unstructured) (1.17.0)
Collecting webencodings (from html5lib->unstructured)
  Downloading webencodings-0.5.1-py2.py3-none-any.whl.metadata (2.1 kB)
Collecting click (from nltk->unstructured)
  Downloading click-8.3.1-py3-none-any.whl.metadata (2.6 kB)
Collecting joblib (from nltk->unstructured)
  Downloading joblib-1.5.2-py3-none-any.whl.metadata (5.6 kB)
Requirement already satisfied: regex>=2021.8.3 in ./.venv/lib/python3.12/site-packages (from nltk->unstructured) (2025.11.3)
Collecting olefile (from python-oxmsg->unstructured)
  Downloading olefile-0.47-py2.py3-none-any.whl.metadata (9.7 kB)
Requirement already satisfied: idna<4,>=2.5 in ./.venv/lib/python3.12/site-packages (from requests->unstructured) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./.venv/lib/python3.12/site-packages (from requests->unstructured) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in ./.venv/lib/python3.12/site-packages (from requests->unstructured) (2025.11.12)
Collecting aiofiles>=24.1.0 (from unstructured-client->unstructured)
  Downloading aiofiles-25.1.0-py3-none-any.whl.metadata (6.3 kB)
Requirement already satisfied: httpcore>=1.0.9 in ./.venv/lib/python3.12/site-packages (from unstructured-client->unstructured) (1.0.9)
Requirement already satisfied: httpx>=0.27.0 in ./.venv/lib/python3.12/site-packages (from unstructured-client->unstructured) (0.28.1)
Requirement already satisfied: pydantic>=2.11.2 in ./.venv/lib/python3.12/site-packages (from unstructured-client->unstructured) (2.12.4)
Requirement already satisfied: pypdf>=6.2.0 in ./.venv/lib/python3.12/site-packages (from unstructured-client->unstructured) (6.3.0)
Requirement already satisfied: requests-toolbelt>=1.0.0 in ./.venv/lib/python3.12/site-packages (from unstructured-client->unstructured) (1.0.0)
Requirement already satisfied: h11>=0.16 in ./.venv/lib/python3.12/site-packages (from httpcore>=1.0.9->unstructured-client->unstructured) (0.16.0)
Requirement already satisfied: anyio in ./.venv/lib/python3.12/site-packages (from httpx>=0.27.0->unstructured-client->unstructured) (4.11.0)
Requirement already satisfied: annotated-types>=0.6.0 in ./.venv/lib/python3.12/site-packages (from pydantic>=2.11.2->unstructured-client->unstructured) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.5 in ./.venv/lib/python3.12/site-packages (from pydantic>=2.11.2->unstructured-client->unstructured) (2.41.5)
Requirement already satisfied: typing-inspection>=0.4.2 in ./.venv/lib/python3.12/site-packages (from pydantic>=2.11.2->unstructured-client->unstructured) (0.4.2)
Requirement already satisfied: sniffio>=1.1 in ./.venv/lib/python3.12/site-packages (from anyio->httpx>=0.27.0->unstructured-client->unstructured) (1.3.1)
Downloading unstructured-0.18.20-py3-none-any.whl (1.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 1.7 MB/s  0:00:01
Downloading cryptography-46.0.3-cp311-abi3-macosx_10_9_universal2.whl (7.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 7.2/7.2 MB 1.8 MB/s  0:00:03
Downloading cffi-2.0.0-cp312-cp312-macosx_11_0_arm64.whl (181 kB)
Downloading backoff-2.2.1-py3-none-any.whl (15 kB)
Downloading beautifulsoup4-4.14.2-py3-none-any.whl (106 kB)
Downloading soupsieve-2.8-py3-none-any.whl (36 kB)
Downloading emoji-2.15.0-py3-none-any.whl (608 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 608.4/608.4 kB 2.9 MB/s  0:00:00
Downloading filetype-1.2.0-py2.py3-none-any.whl (19 kB)
Downloading html5lib-1.1-py2.py3-none-any.whl (112 kB)
Downloading lxml-6.0.2-cp312-cp312-macosx_10_13_universal2.whl (8.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.7/8.7 MB 1.9 MB/s  0:00:04
Downloading nltk-3.9.2-py3-none-any.whl (1.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.5/1.5 MB 1.3 MB/s  0:00:01
Downloading click-8.3.1-py3-none-any.whl (108 kB)
Downloading joblib-1.5.2-py3-none-any.whl (308 kB)
Downloading psutil-7.1.3-cp36-abi3-macosx_11_0_arm64.whl (239 kB)
Downloading pycparser-2.23-py3-none-any.whl (118 kB)
Downloading python_iso639-2025.11.16-py3-none-any.whl (167 kB)
Downloading python_magic-0.4.27-py2.py3-none-any.whl (13 kB)
Downloading python_oxmsg-0.0.2-py3-none-any.whl (31 kB)
Downloading olefile-0.47-py2.py3-none-any.whl (114 kB)
Downloading rapidfuzz-3.14.3-cp312-cp312-macosx_11_0_arm64.whl (1.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.4/1.4 MB 2.5 MB/s  0:00:00
Downloading unstructured_client-0.42.4-py3-none-any.whl (207 kB)
Downloading aiofiles-25.1.0-py3-none-any.whl (14 kB)
Downloading webencodings-0.5.1-py2.py3-none-any.whl (11 kB)
Downloading wrapt-2.0.1-cp312-cp312-macosx_11_0_arm64.whl (61 kB)
Building wheels for collected packages: langdetect
  Building wheel for langdetect (pyproject.toml) ... done
  Created wheel for langdetect: filename=langdetect-1.0.9-py3-none-any.whl size=993332 sha256=f59bf3a8ba5f423166b64b25da6e0bcba56530d0a6571dfbc090077a9f2c2590
  Stored in directory: /Users/binwu/Library/Caches/pip/wheels/c1/67/88/e844b5b022812e15a52e4eaa38a1e709e99f06f6639d7e3ba7
Successfully built langdetect
Installing collected packages: webencodings, filetype, wrapt, soupsieve, rapidfuzz, python-magic, python-iso639, pycparser, psutil, olefile, lxml, langdetect, joblib, html5lib, emoji, click, backoff, aiofiles, python-oxmsg, nltk, cffi, beautifulsoup4, cryptography, unstructured-client, unstructured
Successfully installed aiofiles-25.1.0 backoff-2.2.1 beautifulsoup4-4.14.2 cffi-2.0.0 click-8.3.1 cryptography-46.0.3 emoji-2.15.0 filetype-1.2.0 html5lib-1.1 joblib-1.5.2 langdetect-1.0.9 lxml-6.0.2 nltk-3.9.2 olefile-0.47 psutil-7.1.3 pycparser-2.23 python-iso639-2025.11.16 python-magic-0.4.27 python-oxmsg-0.0.2 rapidfuzz-3.14.3 soupsieve-2.8 unstructured-0.18.20 unstructured-client-0.42.4 webencodings-0.5.1 wrapt-2.0.1
((.venv) ) ➜  uav-nest-agent-by-langchain-and-langgraph (stage2-multi-source-rag) ✗)python3 uav-nest-agent-multi-source.py
✅ Using FastEmbedEmbeddings (free local embedder)
============================================================
🤖 Multi-Source RAG Agent (LangChain Educational Demo)
============================================================

⚠️  This demo is designed to showcase LangChain's limitations
   in multi-source RAG scenarios.

🔧 Initializing Multi-Source RAG Agent...

🔑 请输入你的 DEEPSEEK_API_KEY
   获取地址: https://platform.deepseek.com/
   API Key (输入时会隐藏): 
✅ DEEPSEEK_API_KEY 已接收

🔧 Initializing FastEmbed embeddings (free, local)...
🔧 Initializing DeepSeek Reasoner model...

📚 Step 1: Loading data sources...

============================================================
📚 Loading All Data Sources
============================================================

[1/P1] EVO Nest技术白皮书
  📄 Loading EVO Nest技术白皮书 from evo-nest-data-storage-spec.md...
  ❌ Error loading evo_nest_whitepaper: No module named 'markdown'

[1/P1] DJI Dock技术白皮书
  📄 Loading DJI Dock技术白皮书 from dji-dock-data-storage-spec.md...
  ❌ Error loading dji_dock_whitepaper: No module named 'markdown'

[2/P2] EVO Nest用户手册
  📄 Loading EVO Nest用户手册 from EN_EVO-Nest-Kit-User-Manual_V1.0.1.pdf...
  ✅ Loaded 151 pages

[2/P2] DJI Dock用户手册
  📄 Loading DJI Dock用户手册 from M30_Series_Dock_Bundle_User_Manual_v1.8_CHS.pdf...
  ✅ Loaded 76 pages
  🔍 Filtering by keywords: 存储, 数据管理, 内存, SD, 数据传输, 备份, 容量
  ✅ Filtered to 18 relevant pages

[3/P3] EVO Nest官网介绍
  📄 Loading EVO Nest官网介绍 from evo-nest-official-webpage.md...
  ❌ Error loading evo_nest_webpage: No module named 'markdown'

[3/P3] DJI Dock官网介绍
  📄 Loading DJI Dock官网介绍 from dji-dock-official-webpage.md...
  ❌ Error loading dji_dock_webpage: No module named 'markdown'

============================================================
✅ Successfully loaded 2 data sources
============================================================

🗄️  Step 2: Creating vector stores...

============================================================
🗄️  Creating Vector Stores
============================================================

⚠️  Skipping evo_nest_whitepaper (no documents loaded)

⚠️  Skipping dji_dock_whitepaper (no documents loaded)

[P2] EVO Nest用户手册
  📊 Table: evo_nest_manual
  ✂️  Splitting 151 documents into chunks...
  ✅ Created 382 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

[P2] DJI Dock用户手册
  📊 Table: dji_dock_manual
  ✂️  Splitting 18 documents into chunks...
  ✅ Created 21 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

⚠️  Skipping evo_nest_webpage (no documents loaded)

⚠️  Skipping dji_dock_webpage (no documents loaded)

============================================================
✅ Successfully created 2 vector stores
============================================================

🔍 Step 3: Creating retrievers...

============================================================
🔍 Creating Retrievers
============================================================
  ✅ [P2] EVO Nest用户手册: retriever created (k=5)
  ✅ [P2] DJI Dock用户手册: retriever created (k=5)

============================================================
✅ Created 2 retrievers
   P1 (Whitepapers): 0 retrievers
   P2 (Manuals): 2 retrievers
   P3 (Webpages): 0 retrievers
============================================================

⚙️  Step 4: Setting up RAG chains...

✅ RAG chains configured (prompt template and output parser ready)

🚀 Step 5: Running strategy comparison...

============================================================
🎯 多源RAG策略对比实验
============================================================

问题：EVO Nest机巢的数据存储方案与DJI Dock机场有什么区别？


============================================================
策略1: 简单拼接
============================================================

────────────────────────────────────────────────────────────
📊 策略1: 简单拼接 (Simple Concatenation)
────────────────────────────────────────────────────────────

🔍 检索阶段：
  ✅ P1 (技术白皮书): 0 chunks
/Users/binwu/OOR-local/katas/uav-nest-agent-by-langchain-and-langgraph/uav-nest-agent-multi-source.py:541: LangChainDeprecationWarning: The method `BaseRetriever.get_relevant_documents` was deprecated in langchain-core 0.1.46 and will be removed in 1.0. Use :meth:`~invoke` instead.
  docs = retriever.get_relevant_documents(query)
  ✅ P2 (用户手册): 10 chunks
     - DJI Dock用户手册: 5 chunks
     - EVO Nest用户手册: 5 chunks
  ✅ P3 (官网介绍): 0 chunks
  📦 总计: 10 chunks

💬 生成答案中...
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
        - Avoid using `tokenizers` before the fork if possible
        - Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
        - Avoid using `tokenizers` before the fork if possible
        - Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

⏱️  耗时: 69.4秒

============================================================
策略3: RRF融合
============================================================

────────────────────────────────────────────────────────────
📊 策略3: RRF融合 (RRF Fusion)
────────────────────────────────────────────────────────────
⚠️  LangChain的EnsembleRetriever无法配置数据源优先级权重

🔍 检索阶段（使用LangChain的EnsembleRetriever）：
  ✅ 融合后返回: 10 chunks (LangChain自动去重和重排序)
  📊 数据源分布:
     - P1: 0 chunks
     - P2: 10 chunks
     - P3: 0 chunks

💬 生成答案中...

⏱️  耗时: 87.4秒

============================================================
策略4: 优先级过滤
============================================================

────────────────────────────────────────────────────────────
📊 策略4: 优先级过滤 (Priority Filtering)
────────────────────────────────────────────────────────────
⚠️  LangChain标准RAG链不支持条件分支逻辑
   需要完全自定义实现（阈值=8）

🔍 阶段1: 查询P1 (技术白皮书)...
   → 检索到 0 chunks
   ⚠️  低于阈值 (8)，继续查询P2...

🔍 阶段2: 查询P2 (用户手册)...
   → 检索到 10 chunks
   ✅ P1+P2 超过阈值 (8)，使用P1+P2结果
   ⏭️  跳过P3查询

📦 最终使用: 10 chunks

💬 生成答案中...

⏱️  耗时: 61.3秒

============================================================
📈 策略对比总结
============================================================

────────────────────────────────────────────────────────────
【简单拼接】的回答：
────────────────────────────────────────────────────────────
根据提供的产品文档（仅限P2用户手册），我对EVO Nest和DJI Dock的数据存储方案进行对比分析。需要说明的是，文档中未提供P1技术白皮书或P3官网介绍，因此本分析仅基于用户手册中的信息，可能不涵盖所有技术细节。数据存储方案主要涉及媒体文件（如照片、视频）的存储位置、传输方式和相关配置。

### 数据存储方案对比分析

#### 1. EVO Nest的方案特点
- **本地存储依赖**：EVO Nest套件包含的EVO Max 4T XE飞机配备了**64GB microSD存储卡**，用于本地存储媒体文件（如照片和视频）。这表明数据存储 primarily 依赖于机载存储设备。
- **云服务配置**：用户手册提到“Nest Cloud Service Configuration”章节（Page 9），但未详细说明云存储的具体功能或容量。这暗示云服务可能作为辅助选项，但手册未提供数据传输或云存储的细节（如流量消耗或自动上传机制）。
- **网络设置**：手册提及“Nest Network Setting”（Page 9），但未描述数据如何同步到云或外部系统。整体方案似乎更注重本地存储和手动配置。
- **引用来源**：
  - [EVO Nest用户手册, Page 16]：提到“64GB microSD storage card”作为飞机标配配件。
  - [EVO Nest用户手册, Page 9]：提及“Nest Cloud Service Configuration”，但无具体数据存储说明。

#### 2. DJI Dock的方案特点
- **云平台集成**：DJI Dock默认使用**大疆司空2云平台**进行数据存储和管理。媒体文件（如照片、视频）自动上传至云端，用户可通过云平台查看和管理文件（Page 11）。
- **网络传输与流量消耗**：支持4G无线网络（通过可选DJI Cellular模块）作为有线网络的备份，用于数据传输。手册提供了具体的流量消耗数据：可见光照片约10MB/张、红外照片约1MB/张、录制视频约220MB/分钟、直播约30MB/分钟/路（Page 31）。这表明数据存储主要依赖云平台，且传输过程有明确流量监控。
- **API和第三方集成**：支持通过“大疆上云API”接入第三方云平台（Page 69），提供扩展存储和自定义数据管理选项。
- **本地调试支持**：使用DJI Pilot 2应用和DJI RC Plus遥控器进行本地配置和调试（Page 69），但未强调本地存储；存储重心在云端。
- **引用来源**：
  - [DJI Dock用户手册, Page 11]：描述“上传媒体文件至司空2”的流程。
  - [DJI Dock用户手册, Page 31]：提供4G网络流量消耗数据，并说明媒体文件上传机制。
  - [DJI Dock用户手册, Page 69]：提及云平台支持和API集成。

#### 3. 关键差异总结
- **存储核心**：EVO Nest依赖**本地microSD卡存储**（64GB容量），而DJI Dock侧重于**云平台存储**（司空2），支持自动上传和远程管理。
- **数据传输**：DJI Dock明确支持4G网络备份和流量监控，适用于远程和无人值守场景；EVO Nest手册未提及类似网络传输细节，可能更依赖本地访问或手动配置。
- **扩展性**：DJI Dock通过API支持第三方云集成，提供更灵活的数据存储方案；EVO Nest手册仅提到云服务配置，但未说明扩展选项。
- **用户操作**：EVO Nest可能需要更多本地调试（如microSD卡管理），而DJI Dock通过云平台简化了数据访问和共享。

#### 4. 引用来源标注
- 所有引用均来自提供的P2用户手册：
  - EVO Nest: [EVO Nest用户手册, Page 16] 和 [EVO Nest用户手册, Page 9]
  - DJI Dock: [DJI Dock用户手册, Page 11], [DJI Dock用户手册, Page 31], 和 [DJI Dock用户手册, Page 69]

基于以上分析，EVO Nest的数据存储方案更偏向本地化和硬件依赖，而DJI Dock则强调云集成和网络化存储，适合需要远程数据管理和高可扩展性的应用场景。如果需要更详细的技术规格（如存储容量或加密细节），建议参考P1技术白皮书（未提供）。

⏱️  生成耗时: 69.4秒
📦 使用chunks数: 10个

────────────────────────────────────────────────────────────
【RRF融合】的回答：
────────────────────────────────────────────────────────────
根据提供的产品文档（P2用户手册），以下是EVO Nest和DJI Dock在数据存储方案方面的结构化对比分析。需要注意的是，文档中未提供P1技术白皮书，因此分析仅基于中优先级的用户手册内容。文档中关于数据存储的直接信息有限，但通过相关描述（如存储介质、云服务配置和网络数据传输）可以推断出存储方案的特点。

### 1. EVO Nest的数据存储方案特点
- **本地存储**：EVO Nest的飞行器（EVO Max 4T XE）包含一个64GB microSD存储卡，用于本地存储数据（如照片、视频等）。这表明EVO Nest支持本地数据存储，允许在设备端直接保存媒体文件。
- **云服务配置**：用户手册中提到“Nest Cloud Service Configuration”（巢云服务配置），暗示EVO Nest支持云存储集成，但未提供具体细节（如云平台名称或存储容量）。
- **引用来源**：  
  - [EVO Nest用户手册, Page 16]：提到飞行器包含“64GB microSD storage card”。  
  - [EVO Nest用户手册, Page 9]：目录中列出“5.6 Nest Cloud Service Configuration”，表明支持云服务配置。

### 2. DJI Dock的数据存储方案特点
- **云平台存储**：DJI Dock默认集成“大疆司空2云平台”（DJI司空2），用于数据存储和管理。同时支持通过“大疆上云API”接入第三方云平台，强调云存储和远程访问。
- **网络数据传输**：机场通过有线网络或4G网络（使用DJI Cellular模块）传输数据，消耗流量用于媒体文件上传（如照片、视频）。例如，可见光照片约10MB/张，录制视频约220MB/分钟，直播约30MB/分钟/路。这表明数据主要存储在云平台，而非本地。
- **无明确本地存储**：用户手册中未提及飞行器（经纬M30系列）或机场本身配备本地存储设备（如SD卡），而是依赖网络传输到云平台。
- **引用来源**：  
  - [DJI Dock用户手册, Page 69]：提到“云平台 大疆司空 2 云平台（默认支持）第三方云平台（通过大疆上云 API 开发接入）”。  
  - [DJI Dock用户手册, Page 31]：描述4G网络流量消耗，包括媒体文件大小（如照片和视频），暗示数据上传到云平台。

### 3. 关键差异总结
- **存储位置**：  
  - EVO Nest：提供明确的本地存储（64GB microSD卡），并支持云服务，可能形成混合存储方案。  
  - DJI Dock：依赖云平台存储（如司空2），未提及本地存储，强调云端集成和API访问。
- **存储容量**：  
  - EVO Nest：有具体本地存储容量（64GB），用户可扩展或依赖云服务。  
  - DJI Dock：未指定本地存储容量，云存储容量可能取决于云平台方案。
- **数据传输**：  
  - EVO Nest：未详细描述网络数据传输细节，但本地存储可能减少对网络的依赖。  
  - DJI Dock：明确通过网络（4G/有线）传输数据，流量消耗与媒体文件相关，适合实时监控和远程访问。
- **灵活性与集成**：  
  - EVO Nest：本地存储可能更适合离线环境或数据冗余备份。  
  - DJI Dock：云存储集成更强大，支持第三方平台，适合大规模部署和远程管理。

### 4. 引用来源标注
- EVO Nest引用：  
  - [EVO Nest用户手册, Page 16]：提及64GB microSD存储卡。  
  - [EVO Nest用户手册, Page 9]：提及云服务配置。
- DJI Dock引用：  
  - [DJI Dock用户手册, Page 69]：提及云平台和API集成。  
  - [DJI Dock用户手册, Page 31]：提及网络流量消耗和媒体文件大小。

**注意**：由于文档优先级限制（仅P2用户手册可用），部分细节可能不完整。建议参考P1技术白皮书（如果可用）以获取更权威的技术规格。

⏱️  生成耗时: 87.4秒
📦 使用chunks数: 10个

────────────────────────────────────────────────────────────
【优先级过滤】的回答：
────────────────────────────────────────────────────────────
根据提供的用户手册（P2）文档，我对EVO Nest和DJI Dock的数据存储方案进行了对比分析。需要注意的是，文档中未包含技术白皮书（P1）或官网介绍（P3），因此分析仅基于用户手册信息。数据存储方案主要涉及无人机和机巢/机场的存储介质、数据传输和管理方式。

### 1. EVO Nest的数据存储方案特点
- **本地存储依赖**：EVO Nest方案主要依赖无人机（EVO Max 4T XE飞机）上集成的本地存储介质。根据用户手册，飞机包含一个**64GB microSD存储卡**，用于存储采集的媒体数据（如照片和视频）。机巢本身没有明确提及内置存储或云存储功能，而是通过物理介质进行数据本地保存。
- **配置和调试**：用户手册提到使用USB数据线连接遥控器与机巢进行配置（如网络设置和云服务配置），但未详细说明数据存储或上传机制。这表明数据可能主要通过本地microSD卡管理，需要手动取回或通过其他方式传输。
- **引用来源**：[EVO Nest用户手册, Page 16] 明确指出飞机包含"64GB microSD storage card"。

### 2. DJI Dock的数据存储方案特点
- **云存储优先**：DJI Dock方案强调通过云平台进行数据存储和管理。默认支持**大疆司空2云平台**，媒体文件（如照片、视频）自动通过网络上传到云端。用户还可以通过**大疆上云API**接入第三方云平台，实现灵活的数据集成。
- **网络传输和流量消耗**：数据通过4G无线网络或有线网络传输，媒体文件上传会消耗流量。手册提供了具体流量数据：可见光照片约10MB/张、红外照片约1MB/张、录制视频约220MB/分钟、直播约30MB/分钟/路。这显示存储方案依赖于网络连接，而非本地物理介质。
- **本地调试支持**：虽然云存储是核心，但用户可以使用DJI RC Plus遥控器通过DJI Pilot 2应用进行本地配置和调试，但未提及无人机或机场有内置本地存储（如SD卡）。
- **引用来源**：[DJI Dock用户手册, Page 31] 描述了4G网络流量消耗和媒体文件传输；[DJI Dock用户手册, Page 69] 提到云平台支持和API集成。

### 3. 关键差异总结
- **存储介质**：EVO Nest使用**本地microSD卡（64GB）** 作为主要存储，数据物理存储在无人机上；而DJI Dock采用**云存储**方案，数据通过网络自动上传到云端平台（如司空2），无需依赖本地物理介质。
- **数据管理**：EVO Nest需要手动处理microSD卡的数据传输和备份，可能更适合本地操作或网络受限场景；DJI Dock通过云平台实现远程数据访问、管理和共享，支持自动上传和第三方集成，但依赖稳定网络连接。
- **容量和可扩展性**：EVO Nest的存储容量固定为64GB，可能受限于microSD卡大小；DJI Dock的云存储理论上可无限扩展，但受网络流量和成本影响。
- **适用场景**：EVO Nest适合对数据本地控制和安全性要求高的场景；DJI Dock更适合需要实时远程监控和数据共享的自动化作业。

### 4. 引用来源
- [EVO Nest用户手册, Page 16]：提及64GB microSD存储卡。
- [DJI Dock用户手册, Page 31]：描述4G网络流量消耗和媒体文件传输。
- [DJI Dock用户手册, Page 69]：说明云平台支持和API集成。

此分析基于用户手册，如需更详细的技术规格（如存储速度或加密功能），建议参考更高优先级的文档（如技术白皮书）。

⏱️  生成耗时: 61.3秒
📦 使用chunks数: 10个

============================================================
📊 策略对比指标
============================================================

指标                   策略1             策略3             策略4            
──────────────────────────────────────────────────────────────────────
检索chunks数            10              10              10             
高优先级chunks           0/10 (0%)       0/10 (0%)       0/10 (0%)      
生成耗时(秒)              69.4            87.4            61.3           

============================================================
⚠️  LangChain在多源RAG场景下的局限性
============================================================
1. ❌ 需要手动管理多个检索器，缺乏统一的管理接口
   - 必须分别创建6个vector store和6个retriever
   - 没有DataSourceManager或类似的统一抽象

2. ❌ EnsembleRetriever无法配置数据源优先级权重
   - 所有数据源被平等对待
   - 无法体现"技术白皮书>用户手册>官网"的质量差异

3. ❌ 无法实现条件查询逻辑（如"先查A，不够再查B"）
   - 标准RAG Chain不支持条件分支
   - 策略4需要完全自定义实现100+行代码
   - 无法使用LangChain的Chain抽象

4. ❌ 缺乏查询路由功能
   - 无法根据问题类型自动选择数据源
   - 不能实现"技术问题→白皮书，操作问题→手册"

5. ❌ 多检索器的日志输出混乱，难以追踪
   - 需要手动添加大量print语句才能看清过程
   - 没有内置的可观测性工具

============================================================
💡 这些问题正是LangGraph要解决的！
============================================================

LangGraph提供：
  ✅ 图结构的工作流编排（支持条件分支、循环）
  ✅ 状态管理和条件路由
  ✅ 多Agent协作能力
  ✅ 内置的可观测性和调试工具

下一步可以探索使用LangGraph重构多源RAG系统。
============================================================

============================================================
✨ 演示完成！
============================================================

💡 下一步建议:
   1. 查看输出中的LangChain局限性标注
   2. 对比3种策略的答案质量差异
   3. 探索使用LangGraph重构多源RAG系统

((.venv) ) ➜  uav-nest-agent-by-langchain-and-langgraph (stage2-multi-source-rag) ✗)
```

## Cursor with claude sonnet 4.5:

```
🎉 **恭喜！程序已经成功运行并完成了多源RAG策略对比演示！**

从输出可以看到：

## ✅ 成功的部分

1. **虚拟环境配置成功** - 重建后一切正常
2. **2个数据源成功加载** - EVO Nest和DJI Dock的用户手册（PDF）
3. **3种策略都成功运行** - 简单拼接、RRF融合、优先级过滤
4. **生成了详细的对比报告** - 清晰展示了LangChain的5个核心局限性
5. **答案质量良好** - 基于用户手册成功对比了两种产品的存储方案

## ⚠️ 发现的问题

4个Markdown文件（技术白皮书和官网介绍）没有加载成功，错误信息：
```
❌ Error loading evo_nest_whitepaper: No module named 'markdown'
```

这是因为缺少 `markdown` 包。虽然程序仍然成功运行并展示了局限性，但如果想加载全部6个数据源，需要安装这个包。

## 🔧 建议的下一步

**选项1：安装缺失的包以加载全部6个数据源**

```bash
python3 -m pip install markdown
```

然后重新运行程序，这样就能看到完整的6源对比效果。

**选项2：直接分析当前结果**

当前输出已经非常完整地展示了LangChain的局限性。您可以：
- 对比3种策略的答案（第709-824行）
- 查看策略对比指标（第829-836行）
- 重点阅读"LangChain在多源RAG场景下的局限性"部分（第839-861行）

您希望我安装 `markdown` 包以加载全部数据源，还是直接分析当前的演示结果？
```