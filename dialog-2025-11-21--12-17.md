## Me:

```
(.stage2-venv) ➜  uav-nest-agent-by-langchain-and-langgraph git:(stage2-multi-source-rag) uv pip install -U 'httpx[socks]'
Using Python 3.12.3 environment at: .stage2-venv
Resolved 9 packages in 1.11s
Prepared 1 package in 4ms
Installed 1 package in 9ms
 + socksio==1.0.0
(.stage2-venv) ➜  uav-nest-agent-by-langchain-and-langgraph git:(stage2-multi-source-rag) python3 uav-nest-agent-multi-source.py
```

## Output:

```
✅ Using FastEmbedEmbeddings (free local embedder)
============================================================
🤖 Multi-Source RAG Agent (LangChain Educational Demo)
============================================================

⚠️  This demo is designed to showcase LangChain's limitations
   in multi-source RAG scenarios.

🔧 Initializing Multi-Source RAG Agent...

🔑 请输入你的 DEEPSEEK_API_KEY
   获取地址: https://platform.deepseek.com/
   API Key (输入时会隐藏):
✅ DEEPSEEK_API_KEY 已接收

🔧 Initializing FastEmbed embeddings (free, local)...
🔧 Initializing DeepSeek Reasoner model...

📚 Step 1: Loading data sources...

============================================================
📚 Loading All Data Sources
============================================================

[1/P1] EVO Nest技术白皮书
  📄 Loading EVO Nest技术白皮书 from evo-nest-data-storage-spec.md...
  ✅ Loaded 1 documents

[1/P1] DJI Dock技术白皮书
  📄 Loading DJI Dock技术白皮书 from dji-dock-data-storage-spec.md...
  ✅ Loaded 1 documents

[2/P2] EVO Nest用户手册
  📄 Loading EVO Nest用户手册 from EN_EVO-Nest-Kit-User-Manual_V1.0.1.pdf...
  ✅ Loaded 151 pages

[2/P2] DJI Dock用户手册
  📄 Loading DJI Dock用户手册 from M30_Series_Dock_Bundle_User_Manual_v1.8_CHS.pdf...
  ✅ Loaded 76 pages
  🔍 Filtering by keywords: 存储, 数据管理, 内存, SD, 数据传输, 备份, 容量
  ✅ Filtered to 18 relevant pages

[3/P3] EVO Nest官网介绍
  📄 Loading EVO Nest官网介绍 from evo-nest-official-webpage.md...
  ✅ Loaded 1 documents

[3/P3] DJI Dock官网介绍
  📄 Loading DJI Dock官网介绍 from dji-dock-official-webpage.md...
  ✅ Loaded 1 documents

============================================================
✅ Successfully loaded 6 data sources
============================================================

🗄️  Step 2: Creating vector stores...

============================================================
🗄️  Creating Vector Stores
============================================================

[P1] EVO Nest技术白皮书
  📊 Table: evo_nest_whitepaper
  ✂️  Splitting 1 documents into chunks...
  ✅ Created 6 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

[P1] DJI Dock技术白皮书
  📊 Table: dji_dock_whitepaper
  ✂️  Splitting 1 documents into chunks...
  ✅ Created 9 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

[P2] EVO Nest用户手册
  📊 Table: evo_nest_manual
  ✂️  Splitting 151 documents into chunks...
  ✅ Created 382 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

[P2] DJI Dock用户手册
  📊 Table: dji_dock_manual
  ✂️  Splitting 18 documents into chunks...
  ✅ Created 21 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

[P3] EVO Nest官网介绍
  📊 Table: evo_nest_webpage
  ✂️  Splitting 1 documents into chunks...
  ✅ Created 6 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

[P3] DJI Dock官网介绍
  📊 Table: dji_dock_webpage
  ✂️  Splitting 1 documents into chunks...
  ✅ Created 3 chunks
  🔧 Creating vector store (this may take a moment)...
  ✅ Vector store created

============================================================
✅ Successfully created 6 vector stores
============================================================

🔍 Step 3: Creating retrievers...

============================================================
🔍 Creating Retrievers
============================================================
  ✅ [P1] EVO Nest技术白皮书: retriever created (k=5)
  ✅ [P1] DJI Dock技术白皮书: retriever created (k=5)
  ✅ [P2] EVO Nest用户手册: retriever created (k=5)
  ✅ [P2] DJI Dock用户手册: retriever created (k=5)
  ✅ [P3] EVO Nest官网介绍: retriever created (k=5)
  ✅ [P3] DJI Dock官网介绍: retriever created (k=5)

============================================================
✅ Created 6 retrievers
   P1 (Whitepapers): 2 retrievers
   P2 (Manuals): 2 retrievers
   P3 (Webpages): 2 retrievers
============================================================

⚙️  Step 4: Setting up RAG chains...

✅ RAG chains configured (prompt template and output parser ready)

🚀 Step 5: Running strategy comparison...

============================================================
🎯 多源RAG策略对比实验
============================================================

问题：EVO Nest机巢的数据存储方案与DJI Dock机场有什么区别？


============================================================
策略1: 简单拼接
============================================================

────────────────────────────────────────────────────────────
📊 策略1: 简单拼接 (Simple Concatenation)
────────────────────────────────────────────────────────────

🔍 检索阶段：
/home/ben/OOR/katas/uav-nest-agent-by-langchain-and-langgraph/uav-nest-agent-multi-source.py:541: LangChainDeprecationWarning: The method `BaseRetriever.get_relevant_documents` was deprecated in langchain-core 0.1.46 and will be removed in 1.0. Use :meth:`~invoke` instead.
  docs = retriever.get_relevant_documents(query)
  ✅ P1 (技术白皮书): 10 chunks
     - DJI Dock技术白皮书: 5 chunks
     - EVO Nest技术白皮书: 5 chunks
  ✅ P2 (用户手册): 10 chunks
     - DJI Dock用户手册: 5 chunks
     - EVO Nest用户手册: 5 chunks
  ✅ P3 (官网介绍): 8 chunks
     - DJI Dock官网介绍: 3 chunks
     - EVO Nest官网介绍: 5 chunks
  📦 总计: 28 chunks

💬 生成答案中...

⏱️  耗时: 120.2秒

============================================================
策略3: RRF融合
============================================================

────────────────────────────────────────────────────────────
📊 策略3: RRF融合 (RRF Fusion)
────────────────────────────────────────────────────────────
⚠️  LangChain的EnsembleRetriever无法配置数据源优先级权重

🔍 检索阶段（使用LangChain的EnsembleRetriever）：
  ✅ 融合后返回: 28 chunks (LangChain自动去重和重排序)
  📊 数据源分布:
     - P1: 10 chunks
     - P2: 10 chunks
     - P3: 8 chunks

💬 生成答案中...

⏱️  耗时: 104.4秒

============================================================
策略4: 优先级过滤
============================================================

────────────────────────────────────────────────────────────
📊 策略4: 优先级过滤 (Priority Filtering)
────────────────────────────────────────────────────────────
⚠️  LangChain标准RAG链不支持条件分支逻辑
   需要完全自定义实现（阈值=8）

🔍 阶段1: 查询P1 (技术白皮书)...
   → 检索到 10 chunks
   ✅ 超过阈值 (8)，使用P1结果
   ⏭️  跳过P2和P3查询（P1结果已足够）

📦 最终使用: 10 chunks

💬 生成答案中...

⏱️  耗时: 99.3秒

============================================================
📈 策略对比总结
============================================================

────────────────────────────────────────────────────────────
【简单拼接】的回答：
────────────────────────────────────────────────────────────
基于提供的产品文档（优先级排序：P1技术白皮书 > P2用户手册 > P3官网介绍），以下是对EVO Nest机巢和DJI Dock机场数据存储方案的结构化对比分析。分析重点引用P1技术白皮书中的权威技术规格，辅以P2和P3文档作为补充。

### 1. EVO Nest数据存储方案特点
EVO Nest采用“本地为主、云端为辅”的存储架构，注重离线可用性和灵活的数据管理。关键特点如下：
- **存储硬件配置**：
  - 内置128GB eMMC 5.1高速闪存，读取速度最高250 MB/s，写入速度最高125 MB/s，预期寿命100,000次擦写循环。
  - 存储分区设计：System（20GB）、Cache（80GB，用于无人机数据临时缓存）、Logs（10GB）、Config（2GB）、Reserved（16GB）。Cache分区是核心数据存储区域。
  - 引用来源：[EVO Nest技术白皮书, 存储硬件配置] 和 [EVO Nest技术白皮书, 存储分区设计]

- **数据传输机制**：
  - **无人机到机巢**：主要通过WiFi 6（802.11ax）传输，实际速度150-200 MB/s；备用方案为USB-C 3.1物理传输（最高10 Gbps），在WiFi失败时自动降级。
  - **机巢到云端**：通过4G/5G或以太网上传至Autel AthenaOS云平台，上传速度5-50 MB/s（视网络条件）。支持智能上传策略，按任务优先级分配带宽（如紧急任务实时传输）。
  - 引用来源：[EVO Nest技术白皮书, 数据传输机制] 和 [EVO Nest技术白皮书, 智能上传策略]

- **数据保留与管理**：
  - Cache分区数据默认保留24-72小时，网络恢复后自动上传。支持自定义保留策略（如时长、上传优先级）。
  - 典型场景：30分钟巡检任务（5GB数据）可存储约16次；单日最大处理量500GB。
  - 支持离线导出数据，可通过以太网连接Web管理界面（IP: 192.168.1.100）手动下载。
  - 引用来源：[EVO Nest技术白皮书, 数据保留策略] 和 [EVO Nest技术白皮书, 常见问题]

- **安全与合规**：
  - 传输加密：TLS 1.3；本地存储全盘加密（dm-crypt）。
  - 密钥管理：TPM 2.0硬件安全模块；符合GDPR/PIPL等数据隐私标准。
  - 引用来源：[EVO Nest技术白皮书, 安全与合规]

- **故障处理与恢复**：
  - 网络中断时，数据保留在Cache分区最多72小时，每6小时自动重试上传。
  - 支持多途径恢复：从Cache分区、AthenaOS云端或无人机SD卡读取。
  - 引用来源：[EVO Nest技术白皮书, 故障处理与恢复]

### 2. DJI Dock数据存储方案特点
DJI Dock采用“强云端”架构，本地存储仅作为临时缓冲，强调集中管理和团队协作，但依赖网络连接。关键特点如下：
- **存储硬件配置**：
  - 内置256GB NVMe SSD（高耐用度，3000 TBW写入寿命），在典型使用场景下（每天300GB写入）预计寿命超过25年。
  - 存储分区：Buffer分区最大可用180GB（系统预留部分空间），用于临时缓存数据。
  - 引用来源：[DJI Dock技术白皮书, 存储硬件配置] 和 [DJI Dock技术白皮书, 常见问题]

- **数据传输机制**：
  - **无人机到Dock**：通过O3高速传输（DJI私有协议），Dock 2版本速度达100 MB/s；备用方案为USB 2.0物理传输。
  - **Dock到云端**：通过4G/5G或以太网上传至FlightHub 2云平台，上传速度受网络限制（如以太网最高120 MB/s）。强制要求连接到FlightHub 2，无法使用第三方云或纯本地模式。
  - 引用来源：[DJI Dock技术白皮书, 数据传输机制] 和 [DJI Dock技术白皮书, FlightHub 2集成]

- **数据保留与管理**：
  - 本地数据保留时间短：Buffer分区数据在上传后立即自动删除，保留时间通常<6小时；上传失败的文件最多保留48小时，超时后强制删除。
  - 强制删除规则：数据从无人机SD卡传输到Dock后自动删除；Dock数据上传到云端后自动删除。用户无法配置本地保留副本。
  - 单日最大处理量300GB；必须购买FlightHub 2订阅（按设备数和存储容量计费，如Basic计划$1,200/年）。
  - 引用来源：[DJI Dock技术白皮书, 强制删除规则] 和 [DJI Dock技术白皮书, 性能指标]

- **安全与合规**：
  - 传输加密：O3传输使用DJI私有协议+AES-128；云端传输使用TLS 1.3；静态存储（云端）使用AES-256。
  - 但本地Buffer分区未加密，仅作为临时缓冲。
  - 符合GDPR、CCPA等标准，支持数据存储区域选择。
  - 引用来源：[DJI Dock技术白皮书, 安全与合规]

- **故障处理与恢复**：
  - 数据恢复途径有限：不支持传统本地数据恢复。一旦数据从Dock删除且未上传成功，将永久丢失。唯一恢复方式是从FlightHub 2云端或无人机SD卡（如果未删除）。
  - 网络中断时，数据在Buffer分区保留最多48小时，自动重试上传。
  - 引用来源：[DJI Dock技术白皮书, 数据恢复] 和 [DJI Dock技术白皮书, 故障处理与恢复]

### 3. 关键差异总结
以下是EVO Nest和DJI Dock在数据存储方案上的核心差异对比：

| 特性 | EVO Nest | DJI Dock |
|------|----------|----------|
| **存储架构** | 本地为主，支持离线操作 | 强云端，依赖网络连接 |
| **本地存储容量** | 128GB eMMC（Cache分区80GB） | 256GB SSD（Buffer分区180GB） |
| **数据保留时间** | 24-72小时（可配置） | <6小时（强制删除，不可配置） |
| **离线可用性** | 高，支持离线运行数天，可手动导出数据 | 低，必须连接云端，无本地Web界面 |
| **订阅要求** | 无强制订阅费用 | 必须购买FlightHub 2订阅（额外成本） |
| **数据恢复** | 支持多途径（本地、云端、SD卡） | 仅支持云端或SD卡，无本地恢复 |
| **加密安全性** | 全盘加密（本地和传输） | 本地Buffer分区未加密 |
| **用户控制权** | 高，可配置保留策略、上传优先级 | 有限，仅通过FlightHub 2远程管理 |
| **适用场景** | 偏远地区、离线作业、需灵活数据管理 | 团队协作、网络良好、需集中管理 |

**关键差异总结**：
- EVO Nest注重**离线友好性和数据控制**，适合网络不稳定或需要长期本地存储的场景（如偏远地区巡检）。
- DJI Dock强调**云端集中管理和团队协作**，适合网络条件好、需实时数据共享的企业环境，但依赖订阅且离线能力弱。
- 引用来源：综合自[EVO Nest技术白皮书] 和 [DJI Dock技术白皮书]，特别是[DJI Dock技术白皮书, 数据流转对比] 和 [EVO Nest技术白皮书, 故障处理与恢复]。

### 4. 引用来源标注
- EVO Nest信息主要引用自：[EVO Nest技术白皮书] 的“存储硬件配置”、“数据传输机制”、“数据保留策略”、“安全与合规”等章节。
- DJI Dock信息主要引用自：[DJI Dock技术白皮书] 的“存储硬件配置”、“强制删除规则”、“数据恢复”、“安全与合规”等章节。
- 具体细节如存储容量、传输速度、保留时间等均直接源自P1技术白皮书，确保权威性。P2和P3文档仅作为辅助参考（如官网强调易部署性，但未提供存储细节）。

此分析基于文档优先级，优先采用P1技术白皮书数据，以保证准确性和技术深度。

⏱️  生成耗时: 120.2秒
📦 使用chunks数: 28个

────────────────────────────────────────────────────────────
【RRF融合】的回答：
────────────────────────────────────────────────────────────
根据提供的产品文档（优先级顺序：P1技术白皮书 > P2用户手册 > P3官网介绍），以下是EVO Nest机巢与DJI Dock机场在数据存储方案上的结构化对比分析。分析主要基于P1技术白皮书（最高优先级），并引用具体数据和来源。

### 1. EVO Nest数据存储方案特点
EVO Nest采用"本地为主"的存储架构，注重离线场景的可靠性和灵活性。关键特点包括：
- **存储硬件**：内置128GB eMMC 5.1高速闪存，读取速度最高250 MB/s，写入速度最高125 MB/s，预期寿命100,000次擦写循环。[EVO Nest技术白皮书]
- **存储分区**：128GB存储分配为：System分区20GB（系统固件）、Cache分区80GB（主要数据缓存）、Logs分区10GB（系统日志）、Config分区2GB（配置文件）、Reserved分区16GB（系统保留）。Cache分区是核心数据存储区域。[EVO Nest技术白皮书]
- **数据传输机制**：
  - 无人机到机巢：通过WiFi 6无线传输（实际速度150-200 MB/s），加密使用WPA3-Enterprise + AES-256；备用方案为USB-C物理传输（最高10 Gbps）。[EVO Nest技术白皮书]
  - 机巢到云端：通过4G/5G/以太网上传到Autel AthenaOS云服务器，支持智能上传策略（优先级分级：P0紧急任务实时传输，P1-P3按带宽分配）。[EVO Nest技术白皮书]
- **数据保留与故障处理**：
  - 本地数据保留：Cache分区存储数据24-72小时，网络中断时自动保留并重试上传（每6小时重试，最多72小时）。[EVO Nest技术白皮书]
  - 离线支持：支持手动导出数据，可通过以太网连接Web管理界面（IP: 192.168.1.100）下载数据。[EVO Nest技术白皮书]
  - 存储空间管理：触发自动清理已上传数据，如果不足则暂停新任务。[EVO Nest技术白皮书]
- **加密与安全**：传输使用TLS 1.3加密，本地存储启用全盘加密（dm-crypt），密钥管理基于TPM 2.0硬件安全模块。[EVO Nest技术白皮书]
- **典型性能**：30分钟巡检任务（5GB数据）可存储约16次；单日最大处理量500GB。[EVO Nest技术白皮书]

### 2. DJI Dock数据存储方案特点
DJI Dock采用"强云端"架构，强调数据集中管理和团队协作，但依赖网络连接。关键特点包括：
- **存储硬件**：内置256GB NVMe SSD（高耐用度，3000 TBW写入寿命），在典型场景（每天300GB写入）下预计寿命超过25年。[DJI Dock技术白皮书]
- **存储分区**：Buffer分区最大可用180GB（总256GB扣除系统预留），用于临时缓存数据；设计理念是"数据管道而非仓库"。[DJI Dock技术白皮书]
- **数据传输机制**：
  - 无人机到Dock：通过O3传输（Dock 2速度100 MB/s），加密使用DJI私有协议 + AES-128。[DJI Dock技术白皮书]
  - Dock到云端：强制上传到FlightHub 2云平台，通过网络（4G/5G/以太网）实现，上传速度受网络限制（以太网最高120 MB/s）。[DJI Dock技术白皮书]
- **数据保留与故障处理**：
  - 强制删除规则：数据上传到云端后立即删除本地副本；Buffer分区保留时间通常<6小时，上传失败的文件保留最多48小时，超时后强制删除。[DJI Dock技术白皮书]
  - 离线支持受限：必须连接FlightHub 2云平台，无法配置纯本地存储模式；网络中断时，数据最多保留48小时，但拒绝新任务。[DJI Dock技术白皮书]
  - 数据恢复：不支持本地数据恢复；唯一恢复途径是从FlightHub 2云端或无人机SD卡（如果未删除）。[DJI Dock技术白皮书]
- **加密与安全**：O3传输使用AES-128加密，云端传输使用TLS 1.3，静态存储使用AES-256，但本地Buffer分区未加密。[DJI Dock技术白皮书]
- **订阅要求**：必须购买FlightHub 2订阅（按设备数和存储容量计费，例如Basic计划$1,200/年），无订阅无法使用。[DJI Dock技术白皮书]
- **典型性能**：单日最大处理量300GB；25分钟巡检任务（8GB数据）从无人机到Dock需2分钟，Dock到云端需5-15分钟。[DJI Dock技术白皮书]

### 3. 关键差异总结
基于技术白皮书，两者的核心差异体现在架构哲学、存储策略和适用场景上：
- **架构哲学**：
  - EVO Nest：以本地存储为主，支持离线场景和灵活的数据管理，适合偏远地区或网络不稳定环境。[EVO Nest技术白皮书] 描述其为"本地为主"架构，强调离线友好性。
  - DJI Dock：以云端为中心，强制数据集中到FlightHub 2，适合团队协作和网络良好环境。[DJI Dock技术白皮书] 描述其为"强云端"架构，强调集中管理。
- **存储容量与保留**：
  - EVO Nest的Cache分区80GB提供中期存储（24-72小时），支持手动导出和自动重试；DJI Dock的Buffer分区180GB仅作临时缓冲（<6小时），强制删除策略增加数据丢失风险。[DJI Dock技术白皮书] 对比章节指出DJI Dock"本地存储目的为临时缓冲"，而Autel为"中期存储"。
- **离线支持**：
  - EVO Nest可离线运行数天，数据保留在本地；DJI Dock必须联网，离线场景受限。[DJI Dock技术白皮书] 在数据流转对比中列出DJI Dock"依赖网络连接，离线场景受限"。
- **加密与安全**：
  - EVO Nest实现全盘本地加密；DJI Dock本地Buffer分区未加密，仅云端加密。[DJI Dock技术白皮书] 明确提到"本地存储: ⚠️ Dock的Buffer分区未加密"。
- **成本与订阅**：
  - EVO Nest无强制订阅费用；DJI Dock必须订阅FlightHub 2，产生额外成本。[DJI Dock技术白皮书] 在FAQ中对比指出DJI Dock"必须订阅FlightHub 2（额外成本）"。
- **数据恢复**：
  - EVO Nest支持本地、云端和SD卡恢复；DJI Dock仅支持云端恢复，本地数据删除后永久丢失。[DJI Dock技术白皮书] 在数据恢复章节强调"不支持传统意义上的本地数据恢复"。

### 4. 引用来源
- 所有引用均来自P1技术白皮书（最高优先级），具体来源如下：
  - [EVO Nest技术白皮书]：涵盖存储架构、分区设计、数据传输、加密、故障处理等部分。
  - [DJI Dock技术白皮书]：涵盖存储硬件、数据流转、强制删除策略、加密、订阅要求等部分。
- 为简洁起见，未引用P2和P3，因P1已提供足够权威的技术细节。如需操作细节，可参考P2用户手册，但本分析以技术白皮书为核心。

此对比显示，EVO Nest更适合离线、偏远或数据自主性要求高的场景，而DJI Dock更适合网络稳定、团队协作且预算充足的云端集中管理场景。选择应基于实际网络条件、数据保留需求和成本考量。

⏱️  生成耗时: 104.4秒
📦 使用chunks数: 28个

────────────────────────────────────────────────────────────
【优先级过滤】的回答：
────────────────────────────────────────────────────────────
根据提供的产品文档（仅P1技术白皮书），以下是EVO Nest和DJI Dock数据存储方案的结构化对比分析。文档优先级以P1技术白皮书为最高权威来源，所有引用均基于此。

---

### 1. EVO Nest数据存储方案特点
EVO Nest采用"本地为主、云端为辅"的存储架构，强调离线可用性和灵活的数据管理。关键特点如下：
- **本地存储硬件**：内置128GB eMMC 5.1闪存，读取速度最高250 MB/s，写入速度最高125 MB/s。存储分区包括80GB Cache分区（主要数据缓存）、20GB系统分区等。[EVO Nest技术白皮书, 1.2 存储硬件配置]
- **数据传输机制**：
  - 无人机到机巢：通过WiFi 6（802.11ax）传输，实际速度150-200 MB/s；备用方案为USB-C 3.1（最高10 Gbps），在WiFi失败时自动降级。[EVO Nest技术白皮书, 3.1 数据传输机制]
  - 机巢到云端：支持4G/5G/以太网上传，速度5-50 MB/s（取决于网络）。智能上传策略支持优先级分级（如紧急任务实时传输）。[EVO Nest技术白皮书, 3.2 机巢到云端的传输]
- **数据保留与离线支持**：Cache分区数据保留24-72小时，网络中断时自动缓存并在恢复后上传。支持离线导出数据，可通过以太网连接Web管理界面（IP: 192.168.1.100）手动下载。[EVO Nest技术白皮书, 2.2 数据流转流程] [EVO Nest技术白皮书, FAQ Q2-Q3]
- **安全与加密**：传输使用TLS 1.3加密，本地存储启用dm-crypt全盘加密，密钥由TPM 2.0硬件管理。[EVO Nest技术白皮书, 9.1 数据加密]
- **容量与性能**：单日最大处理量500GB，Cache分区可存储约16次30分钟巡检任务（5GB/次）。支持自定义保留策略（如时长、上传优先级）。[EVO Nest技术白皮书, 7.1 典型场景性能] [EVO Nest技术白皮书, FAQ Q5]
- **故障恢复**：数据可本地恢复（从Cache分区或无人机SD卡），云端上传失败时自动重试（最多72小时）。[EVO Nest技术白皮书, 8.1 故障处理与恢复]

---

### 2. DJI Dock数据存储方案特点
DJI Dock采用"强云端"架构，本地存储仅作为临时缓冲，依赖FlightHub 2云平台进行集中管理。关键特点如下：
- **本地存储硬件**：内置256GB高耐用度NVMe SSD（寿命3000 TBW），Buffer分区最大可用180GB（其余为系统预留）。[DJI Dock技术白皮书, 1.2 存储硬件] [DJI Dock技术白皮书, FAQ Q5]
- **数据传输机制**：
  - 无人机到Dock：通过O3高速传输（速度100 MB/s），失败时降级到USB 2.0物理传输。[DJI Dock技术白皮书, 3.1 数据传输机制]
  - Dock到云端：强制通过FlightHub 2云平台上传，支持4G/5G/以太网（上传速度受网络限制）。无本地存储选项，必须订阅FlightHub 2服务。[DJI Dock技术白皮书, 3.2.2 DJI FlightHub 2集成]
- **数据保留与离线支持**：本地数据保留时间短（通常<6小时），上传成功后自动删除；上传失败的文件最多保留48小时，超时后强制删除。不支持纯离线运行，必须连接云端。[DJI Dock技术白皮书, 4.1 本地数据保留策略]
- **安全与加密**：O3传输使用DJI私有协议+AES-128加密，云端传输使用TLS 1.3，但本地Buffer分区未加密。[DJI Dock技术白皮书, 10.1 数据加密]
- **容量与性能**：单日最大处理量300GB，Buffer分区支持最大8个任务排队。数据访问仅通过FlightHub 2平台，无本地Web界面。[DJI Dock技术白皮书, 7.2 系统容量] [DJI Dock技术白皮书, 10.2 访问控制]
- **故障恢复**：不支持本地数据恢复；一旦数据从Dock删除且未上传，将永久丢失。唯一恢复途径是从FlightHub 2云端或无人机SD卡。[DJI Dock技术白皮书, 9.2 数据恢复]

---

### 3. 关键差异总结
基于技术白皮书，两者的核心差异体现在存储策略、离线能力、安全性和成本等方面：
- **存储策略**：
  - EVO Nest：本地Cache分区作为中期存储（24-72小时），支持灵活的数据管理和离线操作。[EVO Nest技术白皮书, 2.2 数据流转流程]
  - DJI Dock：本地Buffer分区作为临时管道（<6小时），强制云端集中管理，强调团队协作但依赖网络。[DJI Dock技术白皮书, 4.1.1 强制删除规则]
- **离线能力**：
  - EVO Nest：支持离线运行数天，数据可本地导出和保留。[EVO Nest技术白皮书, FAQ Q2-Q3]
  - DJI Dock：离线场景受限，必须连接FlightHub 2云端；网络中断时数据可能丢失。[DJI Dock技术白皮书, 8.2 数据流转对比]
- **安全加密**：
  - EVO Nest：全盘加密（dm-crypt）和TLS 1.3传输，提供端到端保护。[EVO Nest技术白皮书, 9.1 数据加密]
  - DJI Dock：本地Buffer未加密，仅云端和传输加密，存在潜在安全风险。[DJI Dock技术白皮书, 10.1 数据加密]
- **容量与成本**：
  - EVO Nest：本地存储128GB，但单日处理量更高（500GB）；无强制订阅费用。[EVO Nest技术白皮书, 7.2 系统容量]
  - DJI Dock：本地存储256GB更大，但需FlightHub 2订阅（额外成本）；单日处理量较低（300GB）。[DJI Dock技术白皮书, 6.2 FlightHub 2订阅计划] [DJI Dock技术白皮书, 7.2 系统容量]
- **数据恢复**：
  - EVO Nest：支持多途径恢复（本地、云端、SD卡）。[EVO Nest技术白皮书, 8.2 数据恢复]
  - DJI Dock：无本地恢复，数据删除后不可逆。[DJI Dock技术白皮书, 9.2 数据恢复]
- **适用场景**：
  - EVO Nest：适合偏远地区、离线作业或对数据本地控制要求高的场景。[EVO Nest技术白皮书, 8.2 数据流转对比]
  - DJI Dock：适合网络条件好、需要团队协作和集中管理的企业环境。[DJI Dock技术白皮书, 8.2 数据流转对比]

---

### 4. 引用来源标注
- [EVO Nest技术白皮书]：引用自P1文档，包括章节如1.2存储硬件配置、2.2数据流转流程、3.1数据传输机制、8.1故障处理、9.1数据加密等。
- [DJI Dock技术白皮书]：引用自P1文档，包括章节如1.2存储硬件、4.1本地数据保留策略、3.1数据传输机制、9.2数据恢复、10.1数据加密等。

此分析基于技术白皮书的权威数据，确保客观性和准确性。如有更多细节需求（如操作配置），可参考P2用户手册补充。

⏱️  生成耗时: 99.3秒
📦 使用chunks数: 10个

============================================================
📊 策略对比指标
============================================================

指标                   策略1             策略3             策略4
──────────────────────────────────────────────────────────────────────
检索chunks数            28              28              10
高优先级chunks           10/28 (36%)     10/28 (36%)     10/10 (100%)
生成耗时(秒)              120.2           104.4           99.3

============================================================
⚠️  LangChain在多源RAG场景下的局限性
============================================================
1. ❌ 需要手动管理多个检索器，缺乏统一的管理接口
   - 必须分别创建6个vector store和6个retriever
   - 没有DataSourceManager或类似的统一抽象

2. ❌ EnsembleRetriever无法配置数据源优先级权重
   - 所有数据源被平等对待
   - 无法体现"技术白皮书>用户手册>官网"的质量差异

3. ❌ 无法实现条件查询逻辑（如"先查A，不够再查B"）
   - 标准RAG Chain不支持条件分支
   - 策略4需要完全自定义实现100+行代码
   - 无法使用LangChain的Chain抽象

4. ❌ 缺乏查询路由功能
   - 无法根据问题类型自动选择数据源
   - 不能实现"技术问题→白皮书，操作问题→手册"

5. ❌ 多检索器的日志输出混乱，难以追踪
   - 需要手动添加大量print语句才能看清过程
   - 没有内置的可观测性工具

============================================================
💡 这些问题正是LangGraph要解决的！
============================================================

LangGraph提供：
  ✅ 图结构的工作流编排（支持条件分支、循环）
  ✅ 状态管理和条件路由
  ✅ 多Agent协作能力
  ✅ 内置的可观测性和调试工具

下一步可以探索使用LangGraph重构多源RAG系统。
============================================================

============================================================
✨ 演示完成！
============================================================

💡 下一步建议:
   1. 查看输出中的LangChain局限性标注
   2. 对比3种策略的答案质量差异
   3. 探索使用LangGraph重构多源RAG系统
```