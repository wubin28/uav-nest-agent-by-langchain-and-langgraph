# DJI Dock 机场数据存储方案技术白皮书

**文档版本**: v2.1  
**发布日期**: 2023年8月  
**产品型号**: DJI Dock 2 (for DJI Matrice 30/30T series)  
**适用固件版本**: ≥ v01.02.0400  

---

## 1. 系统架构概述

### 1.1 核心处理单元

- **处理器**: DJI自研双核处理器
- **协处理器**: FPGA用于实时数据处理
- **内存**: 4GB LPDDR4 RAM
- **操作系统**: DJI Linux v4.1

### 1.2 存储硬件配置

- **内置存储**: 集成SSD（固态硬盘）
- **存储容量**: 256GB NVMe SSD
- **读取速度**: 最高2000 MB/s (NVMe 3.0)
- **写入速度**: 最高1500 MB/s
- **预期寿命**: 3000 TBW (Total Bytes Written)
- **文件系统**: Btrfs (B-tree file system)

---

## 2. 数据存储架构

### 2.1 存储分区设计

256GB SSD按以下方式分配：

| 分区名称 | 容量 | 用途 | 说明 |
|---------|------|------|------|
| System | 30GB | DJI Pilot 2系统和固件 | 只读，OTA时更新 |
| Buffer | 200GB | 无人机数据临时缓冲区 | **核心数据存储区** |
| Logs | 15GB | 飞行日志和系统诊断 | 滚动日志，保留60天 |
| Config | 5GB | 配置和用户数据 | 持久化存储 |
| Reserved | 6GB | 固件升级和恢复 | 系统保留 |

### 2.2 DJI特有的"零存储"策略

DJI Dock采用**"pass-through"（直通式）存储策略**，与传统本地存储方案有本质区别：

```
无人机 (Matrice 30/30T)
    ↓ (O3图传, 理论15km, 50-100 MB/s)
DJI Dock (Buffer分区, 200GB临时缓存)
    ↓ (4G/5G/以太网, 自动上传)
DJI FlightHub 2云平台
    ↓ (上传成功确认后)
DJI Dock自动删除本地数据 (通常<6小时)
```

**关键特性**:
- **临时性**: SSD仅作为临时缓冲区，不是长期存储
- **自动删除**: 上传成功后立即删除，不保留本地副本
- **强制云端**: 所有数据必须上传到FlightHub 2，无法仅本地存储

---

## 3. 数据传输机制

### 3.1 无人机到机场的传输

#### 3.1.1 O3视频传输系统（DJI独有）

- **传输技术**: DJI OcuSync 3.0 (O3)
- **频段**: 2.4 GHz + 5.8 GHz双频自适应
- **理论传输距离**: 最远15公里（取决于环境）
- **实际传输速度**: 50-100 MB/s
- **传输方式**: 
  - **任务中**: 实时图传，低分辨率预览流（720p/1080p）
  - **降落后**: 高速下载，完整分辨率媒体文件

**传输流程**:
1. 无人机执行任务时，实时图传低分辨率画面到Dock
2. Dock将实时画面推流到FlightHub 2（供远程监控）
3. 任务完成，无人机返航并降落到Dock
4. 降落后，O3系统切换到"高速下载模式"
5. 无人机将完整媒体文件传输给Dock（50-100 MB/s）
6. **传输完成后，无人机自动删除SD卡中的媒体文件**
7. Dock接收到文件后，立即开始上传到FlightHub 2

#### 3.1.2 物理接口（紧急备用）

- **接口类型**: 弹出式充电触点（集成数据传输）
- **传输速度**: 最高480 Mbps (USB 2.0协议)
- **使用场景**: O3传输失败时自动降级
- **触发条件**:
  - O3信号中断>3分钟
  - 传输错误率>10%
  - 无人机电量<15%（优先充电模式）

### 3.2 机场到云端的传输

#### 3.2.1 网络连接方式

**4G LTE支持**:
- 支持频段: B1/B3/B5/B7/B8/B20/B28/B38/B40/B41
- 上传速度: 10-30 MB/s
- 双SIM卡槽（主备切换）
- 流量消耗: 约500GB/月（典型使用场景）

**5G NR支持** (Dock 2新增):
- 支持频段: n1/n3/n5/n7/n8/n28/n41/n77/n78/n79
- 上传速度: 30-80 MB/s
- 双SIM卡5G聚合（带宽叠加）
- 流量消耗: 约800GB/月

**以太网支持**:
- 接口: RJ45 千兆以太网（PoE供电可选）
- 上传速度: 最高120 MB/s（实际受云端服务器限制）
- 推荐使用场景: 固定站点、企业网络环境

**优先级**: 以太网 > 5G > 4G（自动切换）

#### 3.2.2 DJI FlightHub 2集成

**强制要求**:
- DJI Dock **必须**连接到FlightHub 2平台
- 无法配置第三方云平台或纯本地存储模式
- 需要购买FlightHub 2订阅（按设备数量和存储容量计费）

**上传策略**:
- **实时上传**: 任务执行中的低分辨率预览（720p/1080p）
- **优先上传**: 任务完成后的完整媒体文件
- **批量上传**: 系统日志和飞行记录（每日凌晨）

**带宽管理**:
- 自动检测网络带宽
- 可设置上传速度上限（避免占满企业网络）
- 支持QoS（Quality of Service）优先级调度

---

## 4. 数据管理策略

### 4.1 本地数据保留策略

#### 4.1.1 强制删除规则（DJI核心策略）

**无人机端**:
- 媒体文件传输到Dock后，**立即自动删除**
- SD卡仅保留未传输的数据
- 无法配置"保留副本"选项

**Dock端**:
- 媒体文件上传到FlightHub 2后，**立即自动删除**
- Buffer分区保留时间: **通常<6小时**
- 上传失败的文件保留**最多48小时**，超时后删除并告警

**设计理念**:
> "DJI Dock是数据管道，不是数据仓库。所有数据的唯一可靠存储位置是FlightHub 2云平台。"  
> —— DJI Enterprise 官方文档

#### 4.1.2 异常场景处理

| 场景 | Dock行为 | 数据保留 |
|-----|---------|---------|
| 网络完全中断 | 暂停删除，累积数据 | 最多48小时 |
| 云端服务故障 | 每小时重试上传 | 最多48小时 |
| Buffer空间不足 | 拒绝新任务，告警 | 保留现有数据 |
| 48小时超时 | **强制删除**最旧数据 | 告警推送用户 |

### 4.2 数据完整性保护

#### 4.2.1 传输校验

- **无人机→Dock**: CRC-32循环冗余校验
- **Dock→FlightHub 2**: SHA-256哈希验证
- **重传机制**: 检测到损坏自动重传（最多3次）

#### 4.2.2 云端确认机制

```
1. Dock上传文件到FlightHub 2
2. FlightHub 2计算SHA-256哈希值
3. FlightHub 2返回确认消息（包含哈希值）
4. Dock验证哈希值一致
5. 验证成功后，Dock删除本地文件
6. 如果验证失败，Dock保留文件并重新上传
```

---

## 5. 支持的无人机数据格式

### 5.1 照片格式（Matrice 30/30T）

| 格式 | 支持情况 | 最高分辨率 | 说明 |
|-----|---------|-----------|------|
| JPEG | ✅ | 48MP (8000×6000) | 标准输出 |
| DNG (RAW) | ✅ | 48MP | 专业模式 |
| TIFF | ❌ | - | 不支持 |

### 5.2 视频格式

| 格式 | 支持情况 | 最高分辨率 | 码率 |
|-----|---------|-----------|------|
| MP4 (H.264) | ✅ | 4K 30fps | 100 Mbps |
| MP4 (H.265) | ✅ | 4K 60fps | 150 Mbps |
| MOV | ❌ | - | 不支持 |

### 5.3 热成像数据（仅Matrice 30T）

| 格式 | 说明 |
|-----|------|
| R-JPEG | 辐射测温JPEG（嵌入温度数据） |
| TIFF | 16位温度矩阵（可配置） |
| CSV | 温度数据表（用于分析） |

### 5.4 飞行数据

- **飞行日志**: .txt格式（DJI加密）
- **遥测数据**: 集成在视频文件的元数据轨道
- **航点任务**: .kmz格式（包含航点、动作、参数）

---

## 6. 云端存储集成

### 6.1 DJI FlightHub 2平台

- **存储位置**: 
  - 亚太区: AWS Tokyo + 阿里云深圳
  - 欧洲: AWS Frankfurt
  - 美国: AWS Virginia
- **数据加密**: TLS 1.3 (传输) + AES-256 (静态存储)
- **数据备份**: S3跨区域复制（3副本）
- **数据保留**: 
  - 标准订阅: 6个月
  - 企业订阅: 1年或永久（可配置）

### 6.2 FlightHub 2订阅计划

| 计划 | 设备数 | 云存储容量 | 价格（美元/年） |
|-----|-------|-----------|---------------|
| Basic | 1-5 | 100GB | $1,200 |
| Pro | 6-20 | 500GB | $5,000 |
| Enterprise | 无限制 | 2TB起 | 联系销售 |

### 6.3 数据访问方式

- **Web端**: https://flighthub.dji.com
- **移动端**: DJI Pilot 2 (iOS/Android)
- **API**: DJI Cloud API (需申请开发者权限)

---

## 7. 性能指标

### 7.1 典型场景性能

| 场景 | 数据量 | 无人机→Dock | Dock→云端 | 总时长 |
|-----|-------|-------------|----------|--------|
| 25分钟巡检任务 | 8GB视频+照片 | 2分钟 (O3高速模式) | 5-15分钟 (视网络) | 7-17分钟 |
| 90分钟长航时任务 | 35GB视频 | 7分钟 | 15-60分钟 | 22-67分钟 |
| 热成像巡检 | 12GB热成像+可见光 | 3分钟 | 10-25分钟 | 13-28分钟 |

### 7.2 系统容量

- **单日最大处理量**: 300GB（受网络上传速度限制）
- **Buffer分区最大可用**: 180GB（200GB扣除系统预留）
- **最大任务排队数**: 8个（超出则拒绝新任务）

### 7.3 网络流量消耗

**典型企业场景**（每天5次飞行任务）:
- 每月数据量: 约600GB
- 推荐网络套餐: 1TB/月 5G流量包
- 以太网固定站点: 无限流量

---

## 8. 与竞品的关键差异

### 8.1 存储策略对比

| 特性 | DJI Dock | 其他机场（如Autel） |
|-----|----------|------------------|
| 本地存储目的 | **临时缓冲** | **中期存储** |
| 数据保留时间 | <6小时（强制删除） | 24-72小时 |
| 离线可用性 | ❌ 必须连接云端 | ✅ 可离线运行数天 |
| 存储容量 | 256GB SSD | 128GB eMMC |
| 用户可配置性 | ⚠️ 有限（仅删除策略） | ✅ 高度可配置 |

### 8.2 数据流转对比

**DJI Dock的"强云端"架构**:
- ✅ 优点: 数据集中管理，团队协作方便
- ✅ 优点: 无需担心本地存储空间
- ❌ 缺点: 依赖网络连接，离线场景受限
- ❌ 缺点: 订阅费用较高（FlightHub 2必需）

**传统"本地为主"架构**（如Autel）:
- ✅ 优点: 离线场景友好
- ✅ 优点: 无强制订阅费用
- ❌ 缺点: 需要手动管理本地存储空间
- ❌ 缺点: 数据同步和团队协作需额外配置

---

## 9. 故障处理与恢复

### 9.1 常见故障场景

#### 9.1.1 O3传输失败

**症状**:
- 无人机降落后，媒体文件下载进度卡住
- Dock显示"下载错误"

**自动处理**:
1. 尝试重新建立O3连接（3次）
2. 降级到物理接口传输（USB 2.0）
3. 如果USB也失败，保留数据在无人机SD卡
4. 推送告警到FlightHub 2

**用户操作**:
- 检查无人机是否正确停放在Dock上
- 重启Dock（通过FlightHub 2远程重启）
- 手动取出SD卡，通过PC导出数据

#### 9.1.2 云端上传失败

**症状**:
- Buffer分区占用持续增长
- Dock显示"网络异常"或"上传队列：X个文件"

**自动处理**:
1. 每小时自动重试上传
2. 48小时后仍失败，强制删除并告警
3. 推送详细错误日志到FlightHub 2

**用户操作**:
- 检查网络连接（4G/5G信号强度）
- 检查FlightHub 2订阅是否过期
- 检查存储配额是否用尽

#### 9.1.3 存储空间耗尽

**症状**:
- Dock拒绝新任务，显示"存储空间不足"
- Buffer分区使用率>95%

**自动处理**:
1. 暂停接收新的任务
2. 优先上传最早的文件
3. 如果48小时超时，强制删除最旧文件

**用户操作**:
- 检查网络上传速度
- 临时提高上传带宽限制
- 联系DJI支持（可能需要远程清理）

### 9.2 数据恢复

**重要警告**: 
> ⚠️ DJI Dock不支持传统意义上的"本地数据恢复"。一旦数据从Dock删除且未上传成功，**数据将永久丢失**。

**唯一恢复途径**:
- 从FlightHub 2云平台下载（如果已成功上传）
- 从无人机SD卡读取（如果未删除）
- **无法从Dock本地恢复已删除数据**

---

## 10. 安全与合规

### 10.1 数据加密

- **O3传输加密**: DJI私有协议 + AES-128
- **云端传输**: TLS 1.3
- **静态存储**: AES-256 (FlightHub 2云端)
- **本地存储**: ⚠️ Dock的Buffer分区**未加密**（临时性质）

### 10.2 访问控制

- **Dock管理**: 仅通过FlightHub 2 Web/App远程管理
- **无本地Web界面**: 无法通过IP直接访问Dock
- **多因素认证**: DJI账号支持2FA
- **权限管理**: 基于组织架构的多级权限

### 10.3 合规认证

- **数据隐私**: 符合GDPR、CCPA
- **数据主权**: 支持选择数据存储区域（亚太/欧洲/美国）
- **行业认证**: ISO 27001、SOC 2 Type II

### 10.4 审计与监控

- **操作日志**: 所有Dock操作记录在FlightHub 2
- **数据流水**: 完整的数据传输、删除记录
- **告警通知**: 异常事件实时推送（邮件/短信/App）

---

## 11. 版本演进历史

### DJI Dock 1 (2022 Q1)
- 首代产品，搭配Matrice 30系列
- 内置128GB SSD
- 仅支持4G网络
- FlightHub 2集成

### DJI Dock 1.5 (2022 Q3)
- SSD升级到256GB
- 增加5G支持
- O3传输速度优化（50→80 MB/s）

### DJI Dock 2 (2023 Q2) - 当前版本
- 体积减小50%
- 双5G SIM卡聚合
- O3传输速度提升到100 MB/s
- 支持Btrfs文件系统（数据完整性增强）
- 新增"智能压缩"功能（可选）

---

## 12. 高级功能

### 12.1 智能压缩（v2.0新增）

- **可选功能**: 需在FlightHub 2中启用
- **压缩策略**: 
  - 视频: H.265编码，比特率降低30%
  - 照片: JPEG质量从95→85
  - 原始DNG: 可选择不上传（仅上传JPEG）
- **节省流量**: 约40-60%
- **适用场景**: 网络带宽受限的偏远地区

### 12.2 优先级调度

| 任务类型 | 上传优先级 | 说明 |
|---------|-----------|------|
| 紧急任务 | P0 | 立即上传，占满带宽 |
| 定时任务 | P1 | 任务结束后上传 |
| 手动任务 | P2 | 排队上传 |
| 系统日志 | P3 | 夜间上传 |

### 12.3 网络自适应

- 自动检测网络类型（4G/5G/以太网）
- 根据带宽调整并发上传数（1-4个文件）
- 弱网环境自动降低视频码率（任务执行中）

---

## 13. 常见问题 (FAQ)

**Q1: Dock能存储多少次飞行任务的数据？**  
A: 理论上Buffer分区（200GB）可以存储约20次25分钟巡检任务。但实际上，由于自动删除机制，通常同时保留不超过3-5个任务的数据（等待上传）。

**Q2: 如果网络长期中断（超过48小时），数据会怎样？**  
A: **数据将被强制删除**。DJI Dock设计理念是"数据必须在云端"，长期离线使用不是支持的场景。建议在网络不稳定地区部署以太网或使用大流量5G套餐。

**Q3: 能否配置Dock不自动删除本地数据？**  
A: 不能。自动删除是DJI Dock的核心设计，无法通过配置禁用。这是为了保证所有数据集中在FlightHub 2，便于团队协作和安全管理。

**Q4: 可以使用第三方云平台（如AWS、Azure）吗？**  
A: 不可以。DJI Dock仅支持DJI FlightHub 2平台，无法配置第三方云存储。如果有特殊需求，可以通过Cloud API将数据从FlightHub 2导出到其他平台。

**Q5: Dock的SSD会不会用坏？**  
A: DJI使用高耐用度的NVMe SSD（3000 TBW），在典型使用场景下（每天300GB写入），预计寿命超过25年。实际上Dock的其他组件（如机械部件）会更早达到寿命。

**Q6: 对比Autel EVO Nest，DJI Dock的存储方案有什么优势？**  
A: 
- ✅ 优势: 更大的SSD容量（256GB vs 128GB），团队协作更方便（强制云端）
- ❌ 劣势: 离线场景受限，必须订阅FlightHub 2（额外成本）
- 选择建议: 如果团队分布式作业且网络条件好，选DJI；如果偏远地区离线作业为主，选Autel。

---

## 14. 技术支持

- **官方文档**: https://www.dji.com/support/product/dock-2
- **FlightHub 2支持**: https://flighthub.dji.com/support
- **技术支持邮箱**: support@dji.com
- **企业客户专线**: +86-755-26656677 (中国) / +1-818-235-0789 (美国)

---

**文档修订历史**:
- v2.1 (2023-08): 更新Dock 2性能指标，增加智能压缩说明
- v2.0 (2023-05): Dock 2发布，重构架构描述
- v1.5 (2022-10): 增加5G支持说明
- v1.0 (2022-03): 初始版本（Dock 1）

